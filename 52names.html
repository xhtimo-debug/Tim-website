<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>五2班座位表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f3f4f6;
        }
        .desk {
            background-color: white;
            border: 2px solid #374151; /* gray-700 */
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            font-size: 1.125rem; /* text-lg */
            color: #1f2937; /* gray-800 */
            transition: all 0.2s;
            min-height: 60px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            position: relative; /* For z-index context */
        }
        .desk:hover {
            border-color: #3b82f6; /* blue-500 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 5;
        }
        .desk:focus-within {
            border-color: #2563eb; /* blue-600 */
            outline: none;
            ring: 2px solid #bfdbfe;
        }
        .desk input {
            width: 100%;
            text-align: center;
            border: none;
            background: transparent;
            outline: none;
            font-family: inherit;
            color: inherit;
            font-weight: inherit;
            padding: 0.5rem;
            cursor: pointer;
        }
        .desk input:focus {
            cursor: text;
        }
        .podium {
            background-color: #e5e7eb; /* gray-200 */
            border: 2px dashed #9ca3af; /* gray-400 */
            color: #4b5563; /* gray-600 */
        }
        
        /* Highlighting Styles for Random Picker */
        .highlight-selected {
            background-color: #ffff00 !important; /* 纯亮黄色 */
            border-color: #f59e0b !important; /* amber-500 */
            box-shadow: 0 0 25px rgba(255, 230, 0, 0.9) !important; /* 更强的光晕 */
            z-index: 50 !important;
            color: black !important;
            /* font-weight: bold; 已移除，防止文字抖动 */
        }

        @page {
            size: A4 landscape; /* 强制横向打印 */
            margin: 1cm;
        }
        @media print {
            body {
                background-color: white;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print {
                display: none !important;
            }
            .desk {
                border: 1px solid black;
                box-shadow: none;
                break-inside: avoid;
            }
            .podium {
                border: 1px dashed black;
            }
            /* 打印时调整布局间距，防止溢出 */
            .gap-3 {
                gap: 0.5rem;
            }
            .gap-8 {
                gap: 1.5rem;
            }
            .p-4 {
                padding: 0;
            }
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex flex-col items-center">

    <div class="w-full max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8 no-print">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">五2班 座位表</h1>
            <p class="text-gray-500 mb-4">点击名字即可修改内容</p>
            
            <div class="flex justify-center gap-4">
                <button onclick="pickRandomStudent()" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200 flex items-center gap-2 transform active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                    </svg>
                    ✨ 随机点名
                </button>

                <button onclick="window.print()" class="px-6 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors shadow-sm flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                    </svg>
                    打印 / 保存PDF
                </button>
            </div>
        </div>
        
        <!-- Print Header (Only visible when printing) -->
        <div class="hidden print:block text-center mb-6">
            <h1 class="text-2xl font-bold text-black">班级座位表</h1>
        </div>

        <!-- Main Classroom Layout -->
        <div class="flex flex-col md:flex-row justify-center gap-8 md:gap-16 items-start" id="classroom-layout">
            
            <!-- Left Group (2 Columns) -->
            <div class="grid grid-cols-2 gap-3 w-full md:w-auto">
                <!-- Spacer Row to push this group down so Right Group appears higher -->
                <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div>
                <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div>

                <!-- Row 1 -->
                <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div> <!-- Empty -->
                <div class="desk"><input value="张俊驰"></div>
                <!-- Row 2 -->
                <div class="desk"><input value="征诺恩"></div>
                <div class="desk"><input value="周瑞杰"></div>
                <!-- Row 3 -->
                <div class="desk"><input value="王宇阳"></div>
                <div class="desk"><input value="魏冯薃"></div>
                <!-- Row 4 -->
                <div class="desk"><input value="张子瑶"></div>
                <div class="desk"><input value="韩少博"></div>
                <!-- Row 5 -->
                <div class="desk"><input value="葛翰琛"></div>
                <div class="desk"><input value="王子涵"></div>
            </div>

            <!-- Center Group (4 Columns) -->
            <div class="flex flex-col gap-3 w-full md:w-auto">
                <!-- Desk Grid -->
                <div class="grid grid-cols-4 gap-3">
                    <!-- Spacer Row to push this group down so Right Group appears higher -->
                    <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div>
                    <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div>
                    <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div>
                    <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div>

                    <!-- Row 1 -->
                    <div class="desk"><input value="杨若萱"></div>
                    <div class="desk"><input value="瞿子骏"></div>
                    <div class="desk"><input value="袁欣蕊"></div>
                    <div class="desk"><input value="顾鹏毅"></div>
                    <!-- Row 2 -->
                    <div class="desk"><input value="刘恺彤"></div>
                    <div class="desk"><input value="胡宇凡"></div>
                    <div class="desk"><input value="王明轩"></div>
                    <div class="desk"><input value="沈心雨"></div>
                    <!-- Row 3 -->
                    <div class="desk"><input value="王辰旭"></div>
                    <div class="desk"><input value="张佳琪"></div>
                    <div class="desk"><input value="许若欣"></div>
                    <div class="desk"><input value="王夢阳"></div>
                    <!-- Row 4 -->
                    <div class="desk"><input value="钱安然"></div>
                    <div class="desk"><input value="顾高杨"></div>
                    <div class="desk"><input value="蔡梓浩"></div>
                    <div class="desk"><input value="王雨洋"></div>
                    <!-- Row 5 -->
                    <div class="desk"><input value="王馨怡"></div>
                    <div class="desk"><input value="嵇钰轩"></div>
                    <div class="desk"><input value="仇子瞳"></div>
                    <div class="desk"><input value="王雨彤"></div>
                </div>
                
                <!-- Podium Area (Row 6 equivalent) -->
                <div class="grid grid-cols-4 gap-3 mt-4">
                    <div class="desk"><input value="侯铭轩"></div>
                    <div class="desk podium col-span-3 text-xl font-bold tracking-widest pointer-events-none">
                        讲 台
                    </div>
                </div>
            </div>

            <!-- Right Group (2 Columns) -->
            <div class="grid grid-cols-2 gap-3 w-full md:w-auto">
                <!-- Spacers REMOVED to shift group UP -->
                
                <!-- Row 1 -->
                <div class="desk border-transparent bg-transparent shadow-none pointer-events-none"></div> <!-- Empty -->
                <div class="desk"><input value="董馨妍"></div>
                <!-- Row 2 -->
                <div class="desk"><input value="解雅童"></div>
                <div class="desk"><input value="周晨宇"></div>
                <!-- Row 3 -->
                <div class="desk"><input value="顾煜祺"></div>
                <div class="desk"><input value="薛子婷"></div>
                <!-- Row 4 -->
                <div class="desk"><input value="崔铭轩"></div>
                <div class="desk"><input value="赵思涵"></div>
                <!-- Row 5 -->
                <div class="desk"><input value="崔正扬"></div>
                <div class="desk"><input value="韩德宇"></div>
                <!-- Row 6 -->
                <div class="desk"><input value="翟永睿"></div>
                <div class="desk"><input value="王悦萱"></div>
            </div>

        </div>

        <div class="text-center mt-12 text-gray-400 text-sm no-print">
            <p>提示：手写体识别可能存在误差，请核对后打印。</p>
        </div>
    </div>

    <script>
        let isPicking = false;

        function pickRandomStudent() {
            if (isPicking) return;
            isPicking = true;
            
            // Get all valid desks (those with an input that has text)
            const allDesks = Array.from(document.querySelectorAll('.desk'));
            const validDesks = allDesks.filter(desk => {
                const input = desk.querySelector('input');
                // Exclude empty inputs and invisible/spacer desks
                return input && input.value.trim() !== '' && !desk.classList.contains('border-transparent');
            });

            if (validDesks.length === 0) {
                alert('还没有输入学生名字哦！');
                isPicking = false;
                return;
            }

            // Reset previous highlights
            allDesks.forEach(d => d.classList.remove('highlight-selected'));

            let count = 0;
            const maxJumps = 15; // 减少跳动次数，控制在1秒左右
            let currentDelay = 40; // 初始速度加快
            
            // Animation Loop
            function jump() {
                // Clear previous temporary highlight
                validDesks.forEach(d => d.classList.remove('highlight-selected'));

                // Pick a random desk for this jump
                const randomIndex = Math.floor(Math.random() * validDesks.length);
                const selectedDesk = validDesks[randomIndex];
                
                selectedDesk.classList.add('highlight-selected');
                
                count++;

                if (count < maxJumps) {
                    // Slow down gradually in the last few jumps
                    if (count > maxJumps - 5) {
                        currentDelay += 40; // 减速幅度
                    }
                    setTimeout(jump, currentDelay);
                } else {
                    // Final selection - keep it highlighted
                    isPicking = false;
                    
                    // Optional: Scroll into view if on mobile
                    selectedDesk.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            jump();
        }
    </script>
</body>
</html>