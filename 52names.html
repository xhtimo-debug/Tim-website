<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äº”2ç­ç‚¹åå™¨ - æ™ºèƒ½ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            -webkit-tap-highlight-color: transparent;
        }

        /* åŸºç¡€è¯¾æ¡Œæ ·å¼ */
        .desk {
            background-color: white;
            border: 2px solid #cbd5e1; /* slate-300 */
            border-radius: 0.75rem; /* rounded-xl */
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            font-size: 1rem;
            color: #334155; /* slate-700 */
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 56px; /* ä¿è¯æ‰‹æœºç«¯è§¦æ‘¸é«˜åº¦ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: relative;
        }

        /* æ‚¬åœä¸è¾“å…¥çŠ¶æ€ */
        .desk:hover {
            border-color: #60a5fa; /* blue-400 */
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.2);
            z-index: 10;
        }

        .desk:focus-within {
            border-color: #2563eb; /* blue-600 */
            transform: translateY(-2px);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
            z-index: 20;
        }

        /* è¾“å…¥æ¡†æ ·å¼ */
        .desk input {
            width: 100%;
            height: 100%;
            text-align: center;
            border: none;
            background: transparent;
            outline: none;
            font-family: inherit;
            color: inherit;
            font-weight: inherit;
            padding: 0;
            border-radius: inherit;
            cursor: pointer;
        }
        
        .desk input:focus {
            cursor: text;
        }

        /* è®²å°ç‰¹æ®Šæ ·å¼ */
        .podium {
            background-color: #e2e8f0; /* slate-200 */
            border: 2px dashed #94a3b8; /* slate-400 */
            color: #64748b; /* slate-500 */
            box-shadow: none;
        }

        /* éšæœºç‚¹åè¿‡ç¨‹ä¸­çš„æ ·å¼ - åªå˜è‰²ï¼Œä¸æ”¾å¤§ï¼Œé˜²æ­¢æŠ–åŠ¨ */
        .highlight-selected {
            background-color: #fef08a !important; /* yellow-200 */
            border-color: #eab308 !important; /* yellow-500 */
            color: #854d0e !important; /* yellow-900 */
            z-index: 50 !important;
            /* ç§»é™¤äº† scale å’Œ box-shadow çš„å‰§çƒˆå˜åŒ– */
        }

        /* æœ€ç»ˆé€‰ä¸­ï¼ˆä¸­å¥–ï¼‰æ ·å¼ - ç»“æœé†’ç›® */
        .highlight-winner {
            background-color: #fef08a !important; /* yellow-200 */
            border-color: #eab308 !important; /* yellow-500 */
            color: #854d0e !important; /* yellow-900 */
            box-shadow: 0 0 0 6px rgba(234, 179, 8, 0.4), 0 20px 25px -5px rgba(0, 0, 0, 0.2) !important;
            transform: scale(1.15) !important; /* åªæœ‰æœ€åæ‰æ”¾å¤§ */
            z-index: 60 !important;
            font-weight: bold;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); /* å¼¹è·³åŠ¨ç”» */
        }

        /* å ä½ç¬¦è¯¾æ¡Œï¼ˆç”¨äºå¸ƒå±€å¯¹é½ï¼‰ */
        .spacer-desk {
            border-color: transparent;
            background-color: transparent;
            box-shadow: none;
            pointer-events: none;
        }

        /* æ¶ˆæ¯æç¤º Toast */
        #toast {
            visibility: hidden;
            min-width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 12px 16px;
            position: fixed;
            z-index: 100;
            left: 50%;
            top: 30px;
            transform: translateX(-50%);
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s, top 0.3s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        #toast.show {
            visibility: visible;
            opacity: 1;
            top: 50px;
        }

        /* æ‰“å°æ ·å¼ */
        @media print {
            @page {
                size: A4 landscape;
                margin: 0.5cm;
            }
            body {
                background-color: white;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                padding: 0;
            }
            .no-print {
                display: none !important;
            }
            .desk {
                border: 1px solid black;
                box-shadow: none;
                min-height: 45px; /* æ‰“å°æ—¶ç¨å¾®ç´§å‡‘ä¸€ç‚¹ */
                border-radius: 4px;
                break-inside: avoid;
            }
            .podium {
                border: 1px dashed #666;
                background-color: #f0f0f0 !important;
            }
            .highlight-selected, .highlight-winner {
                background-color: white !important;
                border-color: black !important;
                box-shadow: none !important;
                transform: none !important;
                color: black !important;
            }
            /* æ‰“å°æ—¶å¼ºåˆ¶æ¨ªå‘å¸ƒå±€ï¼Œå¿½ç•¥ Tailwind çš„å“åº”å¼å †å  */
            #classroom-layout {
                flex-direction: row !important;
                justify-content: center !important;
                gap: 1.5rem !important; /* gap-6 */
                width: 100% !important;
            }
            /* æ‰“å°æ—¶æ¢å¤å ä½ç¬¦ä»¥ä¿æŒå¯¹é½ */
            .print-spacer {
                display: block !important;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-6 px-4 md:px-8">

    <!-- Toast Notification -->
    <div id="toast">æç¤ºæ¶ˆæ¯</div>

    <div class="w-full max-w-[1400px] mx-auto">
        <!-- Header -->
        <div class="flex flex-col items-center justify-center mb-8 no-print space-y-4">
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-slate-800 tracking-tight">äº”2ç­ç‚¹åå™¨</h1>
                <p class="text-slate-500 text-sm mt-1">ç‚¹å‡»åå­—ä¿®æ”¹ â€¢ æ‰‹æœºå¹³æ¿å®Œç¾é€‚é…</p>
            </div>
            
            <div class="flex flex-wrap justify-center gap-3 w-full sm:w-auto">
                <button onclick="pickRandomStudent()" class="flex-1 sm:flex-none px-6 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 active:bg-indigo-800 transition-all shadow-lg shadow-indigo-200 flex items-center justify-center gap-2 transform active:scale-95 font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                    </svg>
                    éšæœºç‚¹å
                </button>

                <button onclick="window.print()" class="flex-1 sm:flex-none px-6 py-3 bg-white text-slate-700 border border-slate-200 rounded-xl hover:bg-slate-50 active:bg-slate-100 transition-colors shadow-sm flex items-center justify-center gap-2 font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                    </svg>
                    æ‰“å° / ä¿å­˜
                </button>
            </div>
        </div>
        
        <!-- Print Only Header -->
        <div class="hidden print:block text-center mb-6">
            <h1 class="text-2xl font-bold text-black">äº”2ç­ç‚¹åå™¨</h1>
        </div>

        <!-- 
            Main Layout Container 
            1. md:flex-row -> åœ¨ iPad/æ¡Œé¢ç«¯æ¨ªå‘æ’åˆ—
            2. flex-col -> åœ¨æ‰‹æœºç«¯å‚ç›´å †å 
            3. gap-y-8 -> æ‰‹æœºç«¯ç»„ä¸ç»„ä¹‹é—´çš„é—´è·
        -->
        <div class="flex flex-col lg:flex-row justify-center items-start gap-x-4 xl:gap-x-12 gap-y-10 w-full" id="classroom-layout">
            
            <!-- Group 1: Left Side (2 Columns) -->
            <div class="w-full lg:w-auto">
                <div class="text-center lg:hidden mb-2 text-slate-400 text-xs font-bold tracking-widest uppercase">ç¬¬ä¸€ç»„</div>
                <div class="grid grid-cols-2 gap-3 md:gap-4">
                    <!-- Spacers: Hidden on mobile to save space, visible on Desktop for alignment -->
                    <div class="desk spacer-desk hidden lg:block print-spacer"></div>
                    <div class="desk spacer-desk hidden lg:block print-spacer"></div>

                    <!-- Row 1 -->
                    <div class="desk spacer-desk hidden lg:block print-spacer"></div> <!-- Empty Layout Spacer -->
                    <div class="desk"><input value="å¼ ä¿Šé©°"></div>
                    <!-- Row 2 -->
                    <div class="desk"><input value="å¾è¯ºæ©"></div>
                    <div class="desk"><input value="å‘¨ç‘æ°"></div>
                    <!-- Row 3 -->
                    <div class="desk"><input value="ç‹å®‡é˜³"></div>
                    <div class="desk"><input value="é­å†¯è–ƒ"></div>
                    <!-- Row 4 -->
                    <div class="desk"><input value="å¼ å­ç‘¶"></div>
                    <div class="desk"><input value="éŸ©å°‘åš"></div>
                    <!-- Row 5 -->
                    <div class="desk"><input value="è‘›ç¿°ç›"></div>
                    <div class="desk"><input value="ç‹å­æ¶µ"></div>
                </div>
            </div>

            <!-- Group 2: Center Side (4 Columns) -->
            <div class="w-full lg:w-auto">
                <div class="text-center lg:hidden mb-2 text-slate-400 text-xs font-bold tracking-widest uppercase">ç¬¬äºŒç»„ (ä¸­å¤®)</div>
                <div class="flex flex-col gap-3 md:gap-4">
                    <div class="grid grid-cols-4 gap-3 md:gap-4">
                        <!-- Spacers for Desktop alignment -->
                        <div class="desk spacer-desk hidden lg:block print-spacer"></div>
                        <div class="desk spacer-desk hidden lg:block print-spacer"></div>
                        <div class="desk spacer-desk hidden lg:block print-spacer"></div>
                        <div class="desk spacer-desk hidden lg:block print-spacer"></div>

                        <!-- Row 1 -->
                        <div class="desk"><input value="æ¨è‹¥è±"></div>
                        <div class="desk"><input value="ç¿å­éª"></div>
                        <div class="desk"><input value="è¢æ¬£è•Š"></div>
                        <div class="desk"><input value="é¡¾é¹æ¯…"></div>
                        <!-- Row 2 -->
                        <div class="desk"><input value="åˆ˜æºå½¤"></div>
                        <div class="desk"><input value="èƒ¡å®‡å‡¡"></div>
                        <div class="desk"><input value="ç‹æ˜è½©"></div>
                        <div class="desk"><input value="æ²ˆå¿ƒé›¨"></div>
                        <!-- Row 3 -->
                        <div class="desk"><input value="ç‹è¾°æ—­"></div>
                        <div class="desk"><input value="å¼ ä½³çª"></div>
                        <div class="desk"><input value="è®¸è‹¥æ¬£"></div>
                        <div class="desk"><input value="ç‹å¤¢é˜³"></div>
                        <!-- Row 4 -->
                        <div class="desk"><input value="é’±å®‰ç„¶"></div>
                        <div class="desk"><input value="é¡¾é«˜æ¨"></div>
                        <div class="desk"><input value="è”¡æ¢“æµ©"></div>
                        <div class="desk"><input value="ç‹é›¨æ´‹"></div>
                        <!-- Row 5 -->
                        <div class="desk"><input value="ç‹é¦¨æ€¡"></div>
                        <div class="desk"><input value="åµ‡é’°è½©"></div>
                        <div class="desk"><input value="ä»‡å­ç³"></div>
                        <div class="desk"><input value="ç‹é›¨å½¤"></div>
                    </div>
                    
                    <!-- Podium Area -->
                    <div class="grid grid-cols-4 gap-3 md:gap-4 mt-2 lg:mt-6">
                        <div class="desk"><input value="ä¾¯é“­è½©"></div>
                        <div class="desk podium col-span-3 text-lg md:text-xl font-bold tracking-widest pointer-events-none select-none">
                            è®² å°
                        </div>
                    </div>
                </div>
            </div>

            <!-- Group 3: Right Side (2 Columns) -->
            <div class="w-full lg:w-auto">
                <div class="text-center lg:hidden mb-2 text-slate-400 text-xs font-bold tracking-widest uppercase">ç¬¬ä¸‰ç»„</div>
                <div class="grid grid-cols-2 gap-3 md:gap-4">
                    <!-- Spacers hidden on mobile to align properly without gaps -->
                    
                    <!-- Row 1 -->
                    <div class="desk spacer-desk hidden lg:block print-spacer"></div> <!-- Spacer for visual layout -->
                    <div class="desk"><input value="è‘£é¦¨å¦"></div>
                    <!-- Row 2 -->
                    <div class="desk"><input value="è§£é›…ç«¥"></div>
                    <div class="desk"><input value="å‘¨æ™¨å®‡"></div>
                    <!-- Row 3 -->
                    <div class="desk"><input value="é¡¾ç…œç¥º"></div>
                    <div class="desk"><input value="è–›å­å©·"></div>
                    <!-- Row 4 -->
                    <div class="desk"><input value="å´”é“­è½©"></div>
                    <div class="desk"><input value="èµµæ€æ¶µ"></div>
                    <!-- Row 5 -->
                    <div class="desk"><input value="å´”æ­£æ‰¬"></div>
                    <div class="desk"><input value="éŸ©å¾·å®‡"></div>
                    <!-- Row 6 -->
                    <div class="desk"><input value="ç¿Ÿæ°¸ç¿"></div>
                    <div class="desk"><input value="ç‹æ‚¦è±"></div>
                </div>
            </div>

        </div>

        <div class="text-center mt-12 mb-8 text-slate-400 text-xs no-print">
            <p>æç¤ºï¼šå¯ç›´æ¥ç¼–è¾‘åå­— â€¢ æ¨èä½¿ç”¨ A4 çº¸æ¨ªå‘æ‰“å°</p>
        </div>
    </div>

    <script>
        // Toast Notification Function
        function showToast(message, type = 'normal') {
            const toast = document.getElementById("toast");
            toast.textContent = message;
            toast.className = "show";
            
            // Adjust color based on type
            if (type === 'error') toast.style.backgroundColor = "#ef4444"; // red
            else toast.style.backgroundColor = "#333"; // default

            setTimeout(function(){ 
                toast.className = toast.className.replace("show", ""); 
            }, 3000);
        }

        let isPicking = false;

        function pickRandomStudent() {
            if (isPicking) return;
            
            // Get all valid desks
            const allDesks = Array.from(document.querySelectorAll('.desk'));
            const validDesks = allDesks.filter(desk => {
                const input = desk.querySelector('input');
                // Filter out podium, spacers, and empty inputs
                return input && input.value.trim() !== '' && !desk.classList.contains('spacer-desk') && !desk.classList.contains('podium');
            });

            if (validDesks.length === 0) {
                showToast('è¿˜æ²¡è¾“å…¥å­¦ç”Ÿåå­—å“¦ï¼è¯·å…ˆå¡«å†™ã€‚', 'error');
                return;
            }

            isPicking = true;
            // Reset visual states - remove both animation class and winner class
            allDesks.forEach(d => {
                d.classList.remove('highlight-selected');
                d.classList.remove('highlight-winner');
            });

            let count = 0;
            const maxJumps = 20; 
            let currentDelay = 50; 
            
            function jump() {
                // Clear previous temporary highlight
                validDesks.forEach(d => d.classList.remove('highlight-selected'));

                const randomIndex = Math.floor(Math.random() * validDesks.length);
                const selectedDesk = validDesks[randomIndex];
                
                // Use the non-scaling class for animation
                selectedDesk.classList.add('highlight-selected');
                
                // Ensure the jumping highlight is visible on mobile
                if (count === 0 || count === maxJumps) {
                    selectedDesk.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }

                count++;

                if (count < maxJumps) {
                    if (count > maxJumps - 8) {
                        currentDelay *= 1.2; // Slow down exponentially at the end
                    }
                    setTimeout(jump, currentDelay);
                } else {
                    isPicking = false;
                    // Remove the animation class
                    selectedDesk.classList.remove('highlight-selected');
                    // Add the "Winner" class which is bolder and larger
                    selectedDesk.classList.add('highlight-winner');
                    
                    showToast(`é€‰ä¸­äº†ï¼š${selectedDesk.querySelector('input').value} ğŸ‰`);
                    
                    // Center the winner
                    selectedDesk.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            jump();
        }
    </script>
</body>
</html>
